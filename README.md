# Парсер кроссовок по брендам

**Описание:**  
Этот парсер является домашней работой в рамках дисциплины **'Основы Web-API'** и предназначен для сбора данных о кроссовках с сайта **streetfoot.ru**. Приложение запрашивает название бренда у пользователя, а затем собирает информацию о всех моделях выбранного бренда, включая название и цену. Если товары размещены на нескольких страницах, парсер обходит их все и собирает полные данные по каталогу.

Заданием следующей домашней работы является расширение написанного парсера, а именно:
- Сохранение собранной информации в базу данных
- Создание API, для использования приложения через web-интерфейс swagger вместо консоли

Итоговым заданием является расширение парсера при помощи уведомлений через WebSocket: 
-  Все манипуляции с данными (парсинг, обновление, удаление) теперь отправляют уведомления всем подключённым клиентам через WebSocket.  

## Основные возможности:

- **Парсинг данных по бренду:**  
  Получение информации о кроссовках определённого бренда и сохранение её в базе данных.
- **Часть CRUD-операций:**  
  Просмотр, редактирование и удаление данных о кроссовках через API.
- **Уведомления в реальном времени:**  
  WebSocket уведомляет о событиях, таких как обновление, удаление или добавление данных.
- **Swagger UI:**  
  Удобный интерфейс для тестирования API, доступный по адресу `/docs`.

## Технологии:

- **Python 3.10+**
- **FastAPI** — для создания RESTful API.
- **SQLAlchemy (async)** — для работы с базой данных SQLite.
- **BeautifulSoup4 и aiohttp** — для асинхронного парсинга данных.
- **Uvicorn** — для запуска сервера FastAPI.
- **WebSocket** — для уведомлений в реальном времени.

---

## Установка и запуск

### 1. Клонирование репозитория:

```bash
git clone https://github.com/flashikNet/EduParser.git
cd EduParser
```

### 2. Установка зависимостей:

```bash
pip install -r requirements.txt
```

### 3. Запуск приложения:
```bash
cd source/
uvicorn main:app --reload
```

### 4. Доступ к Swagger UI:

Перейдите в браузере по адресу:
<http://127.0.0.1:8000/docs>

---

## API эндпоинты:

### WebSocket:
- **`/ws`**  
  Подключение для получения уведомлений в реальном времени.

### Парсинг данных:
- **`POST /parse/{brand}`**  
  Запускает парсинг кроссовок указанного бренда и сохраняет их в базу данных.

### Получение данных:
- **`GET /sneakers/{brand}`**  
  Возвращает список всех кроссовок указанного бренда из базы данных.

### Обновление данных:
- **`PUT /sneakers/{sneaker_id}`**  
  Обновляет информацию о кроссовке по его ID. Можно обновить название, цену или бренд.

### Удаление данных:
- **`DELETE /sneakers/{sneaker_id}`**  
  Удаляет кроссовок из базы данных по его ID.

---

## Список доступных брендов:

- `adidas`
- `alexander-mcqueen`
- `asics`
- `balenciaga`
- `balmain`
- `cat-sofa`
- `converse`
- `crocs`
- `dc-shoes`
- `dior`
- `dolce-gabbana`
- `dr-martens`
- `fila`
- `golden-goose`
- `merrell`
- `native`
- `new-balance`
- `nike`
- `premiata`
- `puma`
- `reebok`
- `rick-owens`
- `timberland`
- `under-armour`
- `vans`
- `versace`

---

## Примеры запросов через Swagger UI:

1. **Запуск парсинга:**
   ```bash
   POST /parse/crocs
   ```

2. **Получение всех кроссовок бренда:**
   ```bash
   GET /sneakers/nike
   ```

3. **Редактирование данных о кроссовке:**
    ```bash
    PUT /sneakers/1
    Body: 
      {
        "name": "Adidas Superstar",
        "price": "5 999 руб.",
        "brand": "adidas"   
      }
    ```

4. **Удаление кроссовка:**
   ```bash
   DELETE /sneakers/1
   ```

---

## Уведомления через WebSocket:

Подключение к WebSocket на примере javascript:

```javascript
const socket = new WebSocket("ws://127.0.0.1:8000/ws");

socket.onopen = () => {
    console.log("Соединение установлено");
};

socket.onmessage = (event) => {
    console.log("Уведомление:", event.data);
};

socket.onclose = () => {
    console.log("Соединение закрыто");
};
```